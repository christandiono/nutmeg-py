<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>stats.snpm_testing &mdash; Nutmeg-Py Documentation</title>
    <link rel="stylesheet" href="../../static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0-devel',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="top" title="Nutmeg-Py Documentation" href="../../index.html" />
    <link rel="up" title="API" href="../index.html" />
    <link rel="next" title="stats.stats_utils" href="nutmeg.stats.stats_utils.html" />
    <link rel="prev" title="stats.parametric_stats" href="nutmeg.stats.parametric_stats.html" />
  <meta name="keywords" content="nutmeg, meg, magnetic source imaging,
  python, neuroscience">

  </head>
  <body>
  <div id="header">
  <table width="100%">
  <tr>
   <td style="text-align:right;vertical-align:bottom">Nutmeg in Python
    </td>
  </tr>
  </table>
  </div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="nutmeg.stats.stats_utils.html" title="stats.stats_utils"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nutmeg.stats.parametric_stats.html" title="stats.parametric_stats"
             accesskey="P">previous</a> |</li>
  <li><a href="../../index.html">Home</a> |&nbsp;</li>
  <li><a href="../../contents.html">Documentation</a> |&nbsp;</li>

          <li><a href="../index.html" accesskey="U">API</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="">stats.snpm_testing</a><ul>
<li><a class="reference external" href="#module-nutmeg.stats.snpm_testing">Module: <tt class="docutils literal"><span class="pre">stats.snpm_testing</span></tt></a></li>
<li><a class="reference external" href="#classes">Classes</a><ul>
<li><a class="reference external" href="#regenerator"><tt class="docutils literal"><span class="pre">ReGenerator</span></tt></a></li>
<li><a class="reference external" href="#anova-design-generator"><tt class="docutils literal"><span class="pre">anova_design_generator</span></tt></a></li>
<li><a class="reference external" href="#one-sample-ttest-design-generator"><tt class="docutils literal"><span class="pre">one_sample_ttest_design_generator</span></tt></a></li>
<li><a class="reference external" href="#unpaired-ttest-design-generator"><tt class="docutils literal"><span class="pre">unpaired_ttest_design_generator</span></tt></a></li>
</ul>
</li>
<li><a class="reference external" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="nutmeg.stats.parametric_stats.html"
                                  title="previous chapter">stats.parametric_stats</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="nutmeg.stats.stats_utils.html"
                                  title="next chapter">stats.stats_utils</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../sources/api/generated/nutmeg.stats.snpm_testing.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="stats-snpm-testing">
<h1>stats.snpm_testing<a class="headerlink" href="#stats-snpm-testing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-nutmeg.stats.snpm_testing">
<h2>Module: <tt class="xref docutils literal"><span class="pre">stats.snpm_testing</span></tt><a class="headerlink" href="#module-nutmeg.stats.snpm_testing" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="regenerator">
<h3><a title="nutmeg.stats.snpm_testing.ReGenerator" class="reference internal" href="#nutmeg.stats.snpm_testing.ReGenerator"><tt class="xref docutils literal"><span class="pre">ReGenerator</span></tt></a><a class="headerlink" href="#regenerator" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutmeg.stats.snpm_testing.ReGenerator">
<em class="property">
class </em><tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">ReGenerator</tt><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref docutils literal"><span class="pre">object</span></tt></p>
<p>Acts like a generator, but can be reset to the initial state</p>
<dl class="method">
<dt id="nutmeg.stats.snpm_testing.ReGenerator.__init__">
<tt class="descname">__init__</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.ReGenerator.close">
<tt class="descname">close</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator.close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.ReGenerator.next">
<tt class="descname">next</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator.next" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.ReGenerator.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.ReGenerator.send">
<tt class="descname">send</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.ReGenerator.send" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="anova-design-generator">
<h3><a title="nutmeg.stats.snpm_testing.anova_design_generator" class="reference internal" href="#nutmeg.stats.snpm_testing.anova_design_generator"><tt class="xref docutils literal"><span class="pre">anova_design_generator</span></tt></a><a class="headerlink" href="#anova-design-generator" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutmeg.stats.snpm_testing.anova_design_generator">
<em class="property">
class </em><tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">anova_design_generator</tt><big>(</big><em>n_subj</em>, <em>n_cond</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.anova_design_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a title="nutmeg.stats.snpm_testing.ReGenerator" class="reference internal" href="#nutmeg.stats.snpm_testing.ReGenerator"><tt class="xref docutils literal"><span class="pre">nutmeg.stats.snpm_testing.ReGenerator</span></tt></a></p>
<p>An ANOVA design matrix is H*[a,b]^T = X,
where X is [ [tser(i=0,j=0)],</p>
<blockquote>
[tser(i=0,j=1)],
[...], ...] for subjects{i}, conditions{j}</blockquote>
<p>and H is [ eye(n_conditions) ] * n_subjects</p>
<p>Each permutation of H will toggle the labels for a subset of subjects
based on a binary counter patterned selection
(counting from 0 to 2**(n_subjects-1))</p>
<dl class="method">
<dt id="nutmeg.stats.snpm_testing.anova_design_generator.__init__">
<tt class="descname">__init__</tt><big>(</big><em>n_subj</em>, <em>n_cond</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.anova_design_generator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.anova_design_generator.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.anova_design_generator.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="one-sample-ttest-design-generator">
<h3><a title="nutmeg.stats.snpm_testing.one_sample_ttest_design_generator" class="reference internal" href="#nutmeg.stats.snpm_testing.one_sample_ttest_design_generator"><tt class="xref docutils literal"><span class="pre">one_sample_ttest_design_generator</span></tt></a><a class="headerlink" href="#one-sample-ttest-design-generator" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutmeg.stats.snpm_testing.one_sample_ttest_design_generator">
<em class="property">
class </em><tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">one_sample_ttest_design_generator</tt><big>(</big><em>n_obs</em>, <em>half=True</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.one_sample_ttest_design_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a title="nutmeg.stats.snpm_testing.ReGenerator" class="reference internal" href="#nutmeg.stats.snpm_testing.ReGenerator"><tt class="xref docutils literal"><span class="pre">nutmeg.stats.snpm_testing.ReGenerator</span></tt></a></p>
<p>The 1-sample T test design matrix for N observations is simply</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span> <span class="p">])</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>such that H*[a] = X
where X is [ [vox_samples(subj=0)],</p>
<blockquote>
[vox_samples(subj=1)],
[...] ] for all subjects</blockquote>
<p>This generator yields all combinations of matrices that are re-weighted
such that the polarity of rows are flipped. The number of toggled
versions of H is 2**N</p>
<dl class="method">
<dt id="nutmeg.stats.snpm_testing.one_sample_ttest_design_generator.__init__">
<tt class="descname">__init__</tt><big>(</big><em>n_obs</em>, <em>half=True</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.one_sample_ttest_design_generator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n_obs</strong> : int</p>
<blockquote>
<p>Order of the sample</p>
</blockquote>
<p><strong>half</strong> : bool, optional</p>
<blockquote>
<p>Only compute half of the polarity flips (by symmetry, 1/2 of
the matrices have the inverse polarity of the other half)</p>
</blockquote>
<p><strong>random_order: bool, optional</strong> :</p>
<blockquote class="last">
<p>After the first (&#8220;true&#8221;) design matrix, yield reweighted
matrices in random order</p>
</blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.one_sample_ttest_design_generator.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.one_sample_ttest_design_generator.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="unpaired-ttest-design-generator">
<h3><a title="nutmeg.stats.snpm_testing.unpaired_ttest_design_generator" class="reference internal" href="#nutmeg.stats.snpm_testing.unpaired_ttest_design_generator"><tt class="xref docutils literal"><span class="pre">unpaired_ttest_design_generator</span></tt></a><a class="headerlink" href="#unpaired-ttest-design-generator" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="nutmeg.stats.snpm_testing.unpaired_ttest_design_generator">
<em class="property">
class </em><tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">unpaired_ttest_design_generator</tt><big>(</big><em>n_obs_a</em>, <em>n_obs_b</em>, <em>half=True</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.unpaired_ttest_design_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a title="nutmeg.stats.snpm_testing.ReGenerator" class="reference internal" href="#nutmeg.stats.snpm_testing.ReGenerator"><tt class="xref docutils literal"><span class="pre">nutmeg.stats.snpm_testing.ReGenerator</span></tt></a></p>
<p>An unpaired T-test design matrix operates as H*[alpha,beta]^T = X,
where X is [ [vox_samples(subj=0,cond=0)],</p>
<blockquote>
[vox_samples(subj=1,cond=0)],
[...],
[vox_samples(subj=0,cond=1)],
[vox_samples(subj=1,cond=1)],
[...] ] for subjects, and conditions 0 and 1</blockquote>
<p>and H is
&gt;&gt;&gt; H = np.vstack( [ np.repeat([[1.0, 0.0]], n_obs_a, axis=0),</p>
<blockquote>
np.repeat([[0.0, 1.0]], n_obs_b, axis=0) ] )</blockquote>
<p>Each permutation of H will toggle the labels for a subset of subjects
based on a binary counter patterned selection
(counting from 0 to 2**(n_subjects-1)).</p>
<p>The final set of permutations will then be those bit strings where the
number of 0s is equal to n_obs_a, and the number of 1s is equal to n_obs_b.</p>
<p>Furthermore, if the n_obs_a == n_obs_b, then half of the final set is
a bit-flipped mirror of the other half. One half of the set can be
excluded by further contraining the bit strings to begin with 1</p>
<dl class="method">
<dt id="nutmeg.stats.snpm_testing.unpaired_ttest_design_generator.__init__">
<tt class="descname">__init__</tt><big>(</big><em>n_obs_a</em>, <em>n_obs_b</em>, <em>half=True</em>, <em>random_order=True</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.unpaired_ttest_design_generator.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutmeg.stats.snpm_testing.unpaired_ttest_design_generator.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.unpaired_ttest_design_generator.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nutmeg.stats.snpm_testing.binary_pattern">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">binary_pattern</tt><big>(</big><em>n</em>, <em>ncol=None</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.binary_pattern" title="Permalink to this definition">¶</a></dt>
<dd>Returns the first 2**n rows of a binary counting pattern</dd></dl>

<dl class="function">
<dt id="nutmeg.stats.snpm_testing.label_clusters">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">label_clusters</tt><big>(</big><em>stats_image</em>, <em>t_crit</em>, <em>connectivity=18</em>, <em>tail='pos'</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.label_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of cluster labels, an image of clustered labels,
as well as a dictionary of cluster information, keyed by the labels.</p>
<p>dictionary</p>
</dd></dl>

<dl class="function">
<dt id="nutmeg.stats.snpm_testing.rank">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">rank</tt><big>(</big><em>a</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.rank" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nutmeg.stats.snpm_testing.run_snpm_tests">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">run_snpm_tests</tt><big>(</big><em>samps</em>, <em>dgen</em>, <em>beta_comp</em>, <em>n_tests</em>, <em>symmetry=False</em>, <em>smooth_variance=True</em>, <em>analyze_clusters=False</em>, <em>grid_shape=None</em>, <em>vox_map=None</em>, <em>fwhm_pix=None</em>, <em>t_crit=None</em>, <em>connectivity=18</em>, <em>fill_value=0</em>, <em>out=None</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.run_snpm_tests" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>samps</strong> : ndarray</p>
<blockquote>
<p>(samples x nvoxels) array</p>
</blockquote>
<p><strong>dgen</strong> : design matrix generator</p>
<p><strong>beta_comp</strong> : ndarray</p>
<blockquote>
<p>comparison weight(s) for the solution b, in dgen(p)*b = samps</p>
</blockquote>
<p><strong>n_tests</strong> : int</p>
<blockquote>
<p>number of reweighted designs to test</p>
</blockquote>
<p><strong>symmetric</strong> : {True/False}, optional</p>
<blockquote>
<p>If the test combinations provided by dgen represent one symmetrical
half of the possible combinations, then setting this flag will fill
in the results from the other half of the distribution.</p>
</blockquote>
<p><strong>smooth_variance</strong> : {True/False}, optional</p>
<blockquote>
<p>Optionally do spatial smoothing of the variance image.
<strong>Note</strong>: if True, then <em>grid_shape</em>, <em>flat_map</em>, and <em>fwhm_pix</em>
are all required parameters.</p>
</blockquote>
<p><strong>analyze_clusters: {True/False}, optional</strong> :</p>
<blockquote>
<p>Optionally gather additional cluster statistics at each permutation.
<strong>Note</strong>: if True, then <em>grid_shape</em>, <em>flat_map</em>, and <em>t_crit</em>
are all required, and <em>fill_value</em> and <em>connectivity</em> should be provided</p>
</blockquote>
<p><strong>grid_shape</strong> : tuple, optional</p>
<blockquote>
<p>volume shape in which to embed voxel data</p>
</blockquote>
<p><strong>vox_map</strong> : 1D list, optional</p>
<blockquote>
<p>The mapping from tested voxels to indices in the flattened image grid</p>
</blockquote>
<p><strong>fwhm_pix</strong> : len-3 list, optional</p>
<blockquote>
<p>edge lengths for the volume, in units of pixels</p>
</blockquote>
<p><strong>smoothed_variance</strong> : bool, optional</p>
<blockquote>
<p>do spatial variance smoothing</p>
</blockquote>
<p><strong>t_crit</strong> : float, optional</p>
<blockquote>
<p>The <cite>cluster-defining threshold</cite>. This is a statistic drawn from a
theoretical (parametric) distribution.</p>
</blockquote>
<p><strong>connectivity</strong> : int in {6, 18, 26}</p>
<blockquote>
<p>The cluster connectivity rule</p>
</blockquote>
<p><strong>out</strong> : ndarray, optional</p>
<blockquote>
<p>a (n_permutation x voxels) array to store the
empirical null distribution</p>
</blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>test_distribution</strong> : ndarray</p>
<blockquote>
<p>A (n_permutation x voxels) shaped array of the emperical null
distribution. The <cite>true</cite> value test is always in the 0th row.</p>
</blockquote>
<p><strong>clusters</strong> : list</p>
<blockquote class="last">
<p>If analyze_clusters is on, then this function also returns a list
of cluster information for each permutation.</p>
</blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutmeg.stats.snpm_testing.score_clusters">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">score_clusters</tt><big>(</big><em>ext_t</em>, <em>permutation_clusters</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.score_clusters" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ext_t: ndarray</strong> :</p>
<blockquote>
<p>The extreme statistics null distribution for this permutation test</p>
</blockquote>
<p><strong>permutation_clusters: list</strong> :</p>
<blockquote>
<p>List of StatClusters at each permutation for this  test. The
clusters of the true labeling must be in the first sub-list.</p>
</blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>scores, null</strong> :</p>
<blockquote class="last">
<p>The array of scores is based on a <cite>combining function</cite> for each
cluster in the true labeling. The  empirical null distribution
is generated by the max score at each permutation.</p>
</blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutmeg.stats.snpm_testing.statistic_image_from_voxels">
<tt class="descclassname">nutmeg.stats.snpm_testing.</tt><tt class="descname">statistic_image_from_voxels</tt><big>(</big><em>design</em>, <em>samps</em>, <em>beta_comp</em>, <em>img_grid</em>, <em>vox_map</em>, <em>fill_value=0</em>, <em>variance_img=False</em>, <em>fwhm_pix=None</em><big>)</big><a class="headerlink" href="#nutmeg.stats.snpm_testing.statistic_image_from_voxels" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a statistics image from a (n x nvox) matrix of
samples, using the design matrix and a vector of weights to combine
the beta values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>design</strong> : ndarray, (n x p)</p>
<blockquote>
<p>The design matrix for the test</p>
</blockquote>
<p><strong>samps</strong> : ndarray, (n x nvox)</p>
<blockquote>
<p>The samples for each of n tests at each of nvox voxels</p>
</blockquote>
<p><strong>beta_comp</strong> : ndarray, (1 x p)</p>
<blockquote>
<p>Weights for combining the beta values</p>
</blockquote>
<p><strong>img_grid</strong> : array shape (tuple), or 3D ndarray</p>
<blockquote>
<p>Either the array in which to store the stats image, or the shape of
such an array</p>
</blockquote>
<p><strong>vox_map</strong> : sequence</p>
<blockquote>
<p>The mapping from tested voxels to indices in the flattened image grid</p>
</blockquote>
<p><strong>fill_value</strong> : float</p>
<blockquote>
<p>What value to fill in for the non tested voxels in the image</p>
</blockquote>
<p><strong>variance_img</strong> : {True/False}, optional</p>
<blockquote>
<p>Whether or not to compute a smoothed variance image. If an array
is provided for the image grid, that same array will be used as
temporary storage for the variance smoothing, before having the
statistics stored in it.
<strong>Note</strong>: if computing a variance image, then fwhm_pix MUST be
specified.</p>
</blockquote>
<p><strong>fwhm_pix</strong> : sequence, optional</p>
<blockquote>
<p>The FWHM of the smoothing kernel, in units of pixels, for each
dimension of the variance image</p>
</blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>The statistics image</strong> :</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nutmeg.stats.stats_utils.html" title="stats.stats_utils"
             >next</a> |</li>
        <li class="right" >
          <a href="nutmeg.stats.parametric_stats.html" title="stats.parametric_stats"
             >previous</a> |</li>
  <li><a href="../../index.html">Home</a> |&nbsp;</li>
  <li><a href="../../contents.html">Documentation</a> |&nbsp;</li>

          <li><a href="../index.html" >API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009-2010, UCSF Biomagnetic Imaging Laboratory.
      Last updated on Oct 19, 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.2.
    </div>
  </body>
</html>